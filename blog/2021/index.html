<!DOCTYPE html>
<html>

  <head>
  <!DOCTYPE html>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ManageIQ - Blog Posts for 2021</title>
  <meta name="description" content="">
  <meta property="og:image" content="http://manageiq.org/assets/images/logo/manageiq-logo-blue.png" />

  <script>
    stored_theme = localStorage.getItem('miq-theme');
    theme        = stored_theme && JSON.parse(localStorage.getItem('miq-theme'));

    if (theme === "light-theme") {
      document.querySelector('html').classList.add("light-theme");
    }

    if (theme === "dark-theme") {
      document.querySelector('html').classList.add("dark-theme");
    }
  </script>

  <link type="text/css" rel="stylesheet" href="/assets/main-364a522e6cb5aa31700d9562491465966c2c1081a61b11529597f13bf81cfb69.css">
  <link rel="canonical" href="http://manageiq.org/blog/2021/">
  <link rel="alternate" type="application/rss+xml" title="ManageIQ" href="http://manageiq.org/feed.xml">

  <link href="/assets/images/favicon.ico" rel="shortcut icon">
</head>


  <body>
    <header class="site-header">
  <a href="/" class="brand">
    <span class="brand-name">ManageIQ</span>
    <img class="brand-logo" src="/assets/images/manageiq-logo-inverse.svg" alt="ManageIQ Logo">
  </a>

  <div id="site_header-nav_toggle">
    <a href="#" class="off_canvas-show" data-behavior="off_canvas-toggle">
      <i class="fa fa-bars"></i>
    </a>
  </div>

  <div class="off_canvas">
    <header class="off_canvas-header">
      <a href="#" class="off_canvas-hide" data-behavior="off_canvas-toggle">
        <i class="fa fa-times"></i>
      </a>
    </header>

    <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li class="active">
    <a href="/blog/">Blog</a>
  </li>
  <li>
    <button class="fa theme-toggle" data-toggle-theme></i>
  </li>
</ul>

  </div>
</header>


    <main data-url="/blog/2021/">
      <div class="blog blog_year">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-10">
        <header class="blog_header">
          <h1>
            Blog Posts for 2021
          </h1>
        </header>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-sm-10 blog_main">
        
          
            <h2 class="archive_month_title">January</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/01/Announcing-Kasparov-Beta-Jansa-3-And-Ivanchuk-8/">Announcing Kasparov Beta, Jansa-3, and Ivanchuk-8</a></h1>
    </header>

    <div class="post-content">
      <p>ManageIQ Kasparov-1-Beta1.1, Jansa-3, and Ivanchuk-8 are now available. These releases include security fixes. Many thanks goes to Dávid Halász (<a href="https://github.com/skateman">@skateman</a>) and the team for finding and fixing these vulnerabilities.  Also, many thanks go to all of the contributors for all of their enhancements and bug fixes.</p>


    </div>
  </article>
  
</div>

          
            <h2 class="archive_month_title">February</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/02/manageiq-kasparov-ga-announcement/">ManageIQ Kasparov GA announcement</a></h1>
    </header>

    <div class="post-content">
      <p>On behalf of the ManageIQ team, I’m happy to announce the release of <strong>ManageIQ Kasparov</strong>!  This release is named after the great chess grandmaster <a href="https://en.wikipedia.org/wiki/Garry_Kasparov">Garry Kasparov</a>.  You can download the Kasparov-1 release on our <a href="/download">downloads page</a>.</p>


    </div>
  </article>
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/02/manageiq-at-scale-at-kpn/">ManageIQ at scale at KPN</a></h1>
    </header>

    <div class="post-content">
      <h1 id="manageiq-at-scale-at-kpn">ManageIQ at scale at KPN</h1>


    </div>
  </article>
  
</div>

          
            <h2 class="archive_month_title">April</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/04/Announcing-Lasker-Beta/">Announcing Lasker Beta</a></h1>
    </header>

    <div class="post-content">
      <p>The first beta release of ManageIQ Lasker is here!  We’ve been working hard and have a lot of new features you can see in the <a href="https://github.com/orgs/ManageIQ/projects/13#column-11434545">roadmap</a>. Here are the major highlights for this new release:</p>


    </div>
  </article>
  
</div>

          
            <h2 class="archive_month_title">May</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/05/manageiq-perf-results/">ManageIQ performance results and improvements</a></h1>
    </header>

    <div class="post-content">
      <p>This document describes performance measurements for the ManageIQ Kasparov release in both podified and appliance mode, and performance improvements that have been made as a result.  The purpose of these measurements was to show the behavior of ManageIQ as the number of providers and managed resources are increased, and to look for inhibitors to scalability.  Podified measurements were taken on Red Hat OpenShift Container Platform (OCP) running on a VMware vSphere cluster dedicated to performance measurements.  Appliance measurements were taken on a VM running on the same VMware vSphere cluster.</p>

<h2 id="measurement-configuration">Measurement configuration</h2>

<p>These measurements were taken on a vCenter dedicated to performance measurements with the following configuration:</p>

<ul>
  <li>Hypervisor: VMware ESXi, 6.7.0, 15160138</li>
  <li>Model: IBM System X iDataPlex dx360 M4 Server -[7912AC1]-</li>
  <li>Processor Type: Intel(R) Xeon(R) CPU E5-2665 0 @ 2.40GHz</li>
  <li>14 ESX hosts: 16 cores (32 logical processors), 256 GB Total Memory</li>
</ul>

<p>The podified measurements were taken on an OCP cluster with the following characteristics:</p>

<ul>
  <li>OCP 4.6.15</li>
  <li>Kasparov branch</li>
  <li>3 OCP masters (8 core, 32 GB RAM)</li>
  <li>4 workers (8 core, 32 GB RAM)</li>
</ul>

<p>The appliance measurements were taken on a single VM running on the same vSphere cluster, with 16 cores, 64 GB RAM and a separate 200 GB hard disk.</p>

<p>ManageIQ was configured with all server roles enabled, except Git Repositories Owner.  C &amp; U Collection (metric collection) was enabled for all clusters and all datastores.</p>

<p>For these measurements, up to 13 providers were added in a single, default zone:</p>

<ul>
  <li>1 Amazon Web Service cloud provider</li>
  <li>1 Azure cloud provider</li>
  <li>1 VMware infrastructure provider</li>
  <li>10 additional VMware infrastructure providers simulated with the vCenter Server Simulator (VCSIM) tool, which is an unsupported tool available for free from VMware.  Each simulated vCenter runs on a separate VM.</li>
</ul>

<h2 id="steady-state-cpu-utilization">Steady state CPU utilization</h2>

<p><img src="/assets/images/blog/PodSteadyStateCPU.png" /></p>

<p>The figure above shows the average process/pod CPU usage over a 2 hour period with the VMware provider running.  The appliance results (in blue) show the process-level CPU utilization based on data from the Linux ps command.   The podified results (in orange) show the pod-level CPU utilization from prometheus/grafana.  For most worker pods, CPU utilization in podified mode is consistently 8-9% higher than appliance mode.  In investigating this difference, the development team found that the extra overhead was caused by the liveness probe.  <a href="https://github.com/ManageIQ/manageiq-pods/pull/688">Rewriting and optimizing the liveness check</a> resulted in a 20x speedup.  The podified results with the optimized liveness check show up as gray bars in the figure.  The worker pods each show an 8-9% reduction in steady state CPU utilization.  This performance improvement is included in the Lasker branch.</p>

<p>The figure above also shows that the orchestrator CPU usage is lower in podified mode.  This is because the orchestrator pod doesn’t have to do the extra work of collecting worker CPU and memory usage, tracking worker heartbeats, and managing resource limits as it does in appliance mode.  For podified mode, this extra work is handled by Kubernetes.</p>

<p><img src="/assets/images/blog/TotalSteadyStateCPU.png" /></p>

<p>The figure above shows the total steady state ManageIQ CPU usage across all processes/pods for three workload scenarios:</p>
<ul>
  <li>No providers defined</li>
  <li>1 VMware provider</li>
  <li>13 providers
For each workload scenario, the podified CPU usage is dramatically reduced (ranging from 74 to 94% lower) with the liveness probe improvement.  With the improvement, total ManageIQ podified CPU usage is lower than appliance mode in each case.</li>
</ul>

<h2 id="vmdb-database-measurements">VMDB database measurements</h2>

<p>The ManageIQ architecture includes the Virtual Management Database (VMDB), which is “the definitive source of intelligence collected about your Virtual Infrastructure”.  During our performance measurements, we collected postgres statistics to see the total size, number of rows and activity for each of the 300+ tables in the VMDB database.</p>

<p>The biggest tables in the vmdb database are related to metric collection.  The following observations are based on the postgres stats and discussion with development:</p>

<ul>
  <li>24 raw tables, one per hour (metrics_00, metrics_01 … metrics_23)
    <ul>
      <li>Only the most recent four hours of raw metrics are kept, and every hour, the table with data older than 4 hours is truncated.</li>
      <li>For each resource, metrics are collected in 20 second intervals.  Each resource gets one metric row per collection interval, with up to 180 rows collected per hour.</li>
      <li>For the VMware data provider, collected resources are clusters, hosts and VMs.</li>
      <li>For the AWS data provider, the collected resources are online instances (not offline or suspended)</li>
      <li>For the Azure data provider, metrics are not collected unless the Microsoft.Insights resource provider is enabled, which was not the case in our measurements</li>
      <li>The average row size for raw metrics is 715 bytes, based on observations with the VMware data provider.</li>
    </ul>
  </li>
  <li>12 rollup tables, one per month (metric_rollups_01, metric_rollups_02 … metric_rollups_12)
    <ul>
      <li>Each resource gets one metric_rollups row per hour and another metric_rollup row per day.</li>
      <li>The average row size for metric_rollups is 680 bytes, based on observations with the VMware data provider.</li>
    </ul>
  </li>
  <li>vim_performance_states table
    <ul>
      <li>This table gets one row, per resource per hour, for each resource with records in the metric_rollups tables.  The rows in this table represent the state of the resource when the rollup was performed.</li>
      <li>The average row size for the vim_performance_state table is 716 bytes, base on observations with the VMware data provider.</li>
    </ul>
  </li>
</ul>

<p>If metric collection is enabled, the above tables will be by far the biggest contributors to the vmdb database size.<br />
To estimate the size of the metric collection portion of the database, you could use the following formula to estimate the storage in MB for one year for a given number of resources.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(number of resources) * ((180 raw rows/hour * 4 hours * 715 bytes/row) +  (25 rollup rows/day  * 365 days * (680 bytes/row) + (25 vim_performance_states rows/day * 365 days * 716 bytes/row))) / 1024 /1024
</code></pre></div></div>

<p>Which reduces to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(number of resources) * 12.6 MB 
</code></pre></div></div>

<p>For 1,000 resources, the tables related to metric collection should grow to about 12 GB.</p>

<h2 id="conclusion">Conclusion</h2>

<p>This article describes results from our recent performance measurements of the ManageIQ Kasparov branch, including performance improvements that were made based on these findings.  The results show that, with these improvements, ManageIQ in podified mode can perform as well or better than appliance mode.</p>

    </div>
  </article>
  
</div>

          
            <h2 class="archive_month_title">July</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/07/cve-2021-32756-kasparov-2-jansa-4/">CVE-2021-32756, Kasparov-2, Jansa-4</a></h1>
    </header>

    <div class="post-content">
      <p>ManageIQ Kasparov-2 and Jansa-4 are now available. These releases include a security fix, which is also included in the new Lasker-1 GA release. Many thanks goes to Jason Frey (<a href="https://github.com/Fryguy">@Fryguy</a>) and Gregg Tanzillo (<a href="https://github.com/gtanzillo">@gtanzillo</a>) for finding and fixing these vulnerabilities.  Also, many thanks go to all of the contributors for all of their enhancements and bug fixes.</p>


    </div>
  </article>
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/07/manageiq-lasker-ga-annoucement/">ManageIQ Lasker GA Announcement</a></h1>
    </header>

    <div class="post-content">
      <p>On behalf of the ManageIQ team, I’m happy to announce the release of <strong>ManageIQ Lasker</strong>!  This release is named after the chess grandmaster <a href="https://en.wikipedia.org/wiki/Emanuel_Lasker">Emanuel Lasker</a>.  You can download the Lasker-1 release on our <a href="/download">downloads page</a>.</p>


    </div>
  </article>
  
</div>

          
            <h2 class="archive_month_title">August</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/08/announcing_morphy_approach/">Morphy Release Approach</a></h1>
    </header>

    <div class="post-content">
      <p>We have been working on a number of interesting features.  Typically, the way these get released is that we cut a release branch from the <code class="language-plaintext highlighter-rouge">master</code> branch and work on stabilizing it to get to a release.  However, at this time we feel the master branch is a bit too fluid to stabilize just yet.  At the same time, there are a number of new features that are less risky and would provide a benefit to the community via an official release.  So, what we have decided to do is to release them in a different way.</p>


    </div>
  </article>
  
</div>

          
            <h2 class="archive_month_title">December</h2>
            <div class="posts month_archive">
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/12/Announcing-Morphy-Beta/">Announcing Morphy Beta</a></h1>
    </header>

    <div class="post-content">
      <p>The first beta release of ManageIQ Morphy is here!  We’ve been working hard and have a lot of new features you can see in the <a href="https://github.com/orgs/ManageIQ/projects/13#column-15656536">roadmap</a>. Here are the major highlights for this new release:</p>


    </div>
  </article>
  
  <article class="post_excerpt">
    <header class="post-header">
      <h1><a href="/blog/2021/12/rbvmomi-maintenance/">RbVmomi Maintenance</a></h1>
    </header>

    <div class="post-content">
      <p>I have the pleasure of announcing that the <a href="https://www.manageiq.org/community/">ManageIQ community</a> has forked and will be maintaining the RbVmomi gem as rbvmomi2.  RbVmomi is a Ruby SDK for the <a href="https://code.vmware.com/apis/1131/vsphere">VMware vSphere Web Services API</a> which allows users to manage their virtual infrastructure.</p>


    </div>
  </article>
  
</div>

          
        
      </div>

      <div class="col-xs-12 col-sm-2 blog_side">
        <div class="blog_side-group">
  <h3 class="blog_side-heading">
    Categories
  </h3>

  <ul id="blog_tag_menu" class="blog_menu">
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/announcements">announcements</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/events">events</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/collaboration">collaboration</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/releases">releases</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/sprints">sprints</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/LWIMIQ">LWIMIQ</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/developers">developers</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/tutorials">tutorials</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/ruby">ruby</a>
    </li>
    
    <li class="blog_menu-tag">
      <a href="/blog/tags/performance">performance</a>
    </li>
    
  </ul>
</div>

<div class="blog_side-group">
  <h3 class="blog_side-heading">
    Archive
  </h3>

  <ul id="blog_archive_menu" class="blog_menu">
    
    
    

    
    <li class="blog_menu-year">
      <a href="/blog/2021/index.html">
        2021
      </a>
      
        <ul class="blog_menu blog_months">
  
  
  <li class="blog_menu-month">
    <a href="/blog/2021/12/index.html">
      December
    </a>
    
  </li>
  
  <li class="blog_menu-month">
    <a href="/blog/2021/08/index.html">
      August
    </a>
    
  </li>
  
  <li class="blog_menu-month">
    <a href="/blog/2021/07/index.html">
      July
    </a>
    
  </li>
  
  <li class="blog_menu-month">
    <a href="/blog/2021/05/index.html">
      May
    </a>
    
  </li>
  
  <li class="blog_menu-month">
    <a href="/blog/2021/04/index.html">
      April
    </a>
    
  </li>
  
  <li class="blog_menu-month">
    <a href="/blog/2021/02/index.html">
      February
    </a>
    
  </li>
  
  <li class="blog_menu-month">
    <a href="/blog/2021/01/index.html">
      January
    </a>
    
  </li>
  
</ul>

      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2020/index.html">
        2020
      </a>
      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2019/index.html">
        2019
      </a>
      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2018/index.html">
        2018
      </a>
      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2017/index.html">
        2017
      </a>
      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2016/index.html">
        2016
      </a>
      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2015/index.html">
        2015
      </a>
      
    </li>
    
    <li class="blog_menu-year">
      <a href="/blog/2014/index.html">
        2014
      </a>
      
    </li>
    
  </ul>
</div>

      </div>

    </div>
  </div>
</div>

    </main>

    <footer class="site-footer">
  <div class="footer-row" id="footer_top">
    <div class="footer-group">
      <img class="footer-logo" src="/assets/images/manageiq-glyph-inverse.svg" alt="ManageIQ">
      <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li class="active">
    <a href="/blog/">Blog</a>
  </li>
  <li>
    <button class="fa theme-toggle" data-toggle-theme></i>
  </li>
</ul>

    </div>


    <ul class="contact_menu">
      <li>
        <a href="https://github.com/ManageIQ/">
          <i class="fa fa-github"></i>
          Github
        </a>
      </li>
      <li>
        <a href="https://gitter.im/ManageIQ/manageiq">
          <i class="fa fa-gitter">
            <svg viewBox="45 47 78 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 40.1 (33804) - http://www.bohemiancoding.com/sketch -->
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Artboard" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(45.000000, 47.000000)">
        <g id="icon-gitter" transform="translate(10.000000, 0.000000)">
            <rect id="Rectangle-path" x="0" y="0.5" width="8.25" height="61"></rect>
            <rect id="Rectangle-path" x="49.75" y="14.5" width="8.25" height="47"></rect>
            <rect id="Rectangle-path" x="16.5" y="14.5" width="8.25" height="80.25"></rect>
            <rect id="Rectangle-path" x="33.25" y="14.5" width="8.25" height="80.25"></rect>
        </g>
    </g>
</svg>

          </i>
          Gitter
        </a>
      </li>
      <li>
        <a href="http://talk.manageiq.org/">
          <i class="fa fa-comments"></i>
          Forum
        </a>
      </li>
      
      <li>
        <a href="https://github.com/ManageIQ/manageiq.org/edit/master/site/blog/2021/index.html">
          <i class="fa fa-pencil"></i>
          Edit this page
        </a>
      </li>
      
    </ul>
  </div>

  <div class="footer-row" id="footer_bottom">
    <div class="footer-legal">
      <span class="copyright">
        &copy; 2021 ManageIQ.
      </span>
      <span>
        <a href="http://community.redhat.com/software/" target="_blank">
          Sponsored by Red Hat, Inc.
        </a>
      </span>
      <span>
        <a href="/logo/" class="footer-link">Logo</a>
      </span>
      <span>
        <a href="/security/" class="footer-link">Security</a>
      </span>
      <span>
        <a href="/legal/" class="footer-link">Legal &amp; Privacy</a>
      </span>
    </div>

    <div class="footer-social">
      <ul class="social_menu">
        <li>
          <a href="https://twitter.com/ManageIQ" class="social_link social_link-twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>

        <li>
          <a href="https://www.facebook.com/manageiq/" class="social_link social_link-facebook">
            <span class="social_link-icon">
              <i class="fa fa-facebook"></i>
            </span>
          </a>
        </li>

        <!--  -->
        <li>
          <a href="https://www.linkedin.com/company/manageiq" class="social_link social_link-linkedin">
            <span class="social_link-icon">
              <i class="fa fa-linkedin"></i>
            </span>
          </a>
        </li>

        <li>
          <a href="https://www.youtube.com/user/ManageIQVideo" class="social_link social_link-youtube">
            <span class="social_link-icon">
              <i class="fa fa-youtube"></i>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

    <div id="lightbox">
  <header class="lightbox-header">
    <div class="lightbox-title"></div>
    <div class="lightbox-close">
      <span class="fa fa-times"></span>
    </div>
  </header>

  <div class="lightbox-image">
    <img src="" alt="">
  </div>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="/assets/js/main.js" charset="utf-8"></script>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58883457-1', 'auto');
  ga('send', 'pageview');

</script>
    
  </body>
</html>
