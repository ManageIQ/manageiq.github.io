<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ManageIQ</title>
  <meta name="description" content="">
  <meta property="og:image" content="http://manageiq.org/assets/images/logo/manageiq-logo-blue.png" />
  
  <link type="text/css" rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://manageiq.org/docs/guides/developer_setup/running_test_suites">
  <link rel="alternate" type="application/rss+xml" title="ManageIQ" href="http://manageiq.org/feed.xml">

  <link href="/assets/images/favicon.ico" rel="shortcut icon">
</head>


  <body>
    <header class="site-header">
  <a href="/" class="brand">
    <span class="brand-name">ManageIQ</span>
    <img class="brand-logo" src="/assets/images/manageiq-logo-inverse.svg" alt="ManageIQ Logo">
  </a>

  <div id="site_header-nav_toggle">
    <a href="#" class="off_canvas-show" data-behavior="off_canvas-toggle">
      <i class="fa fa-bars"></i>
    </a>
  </div>

  <div class="off_canvas">
    <header class="off_canvas-header">
      <a href="#" class="off_canvas-hide" data-behavior="off_canvas-toggle">
        <i class="fa fa-times"></i>
      </a>
    </header>

    <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li >
    <a href="/blog/">Blog</a>
  </li>
</ul>

  </div>
</header>


    <main data-url="/docs/guides/developer_setup/running_test_suites">
      <nav class="doc_tabs">
  <ul>
  <li>
    <a href="/docs/get-started/">Get Started</a>
  </li>
  <li>
    <a href="/docs/reference/">User Reference</a>
  </li>
  <li>
    <a href="/docs/automation">
      Automation Book
    </a>
  </li>
  <li>
    <a href="/docs/api">
      API Docs
    </a>
  </li>
  <li class="active">
    <a href="/docs/guides/README">Developer Guides</a>
  </li>
</ul>

</nav>

<div class="doc_container">
  <div class="doc_menu">
    
    

<ul class="menu menu-toplevel" id="guides_menu">

  
  
  
  <li class="menu-parent">
    
    <a href="#">
      Architecture
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/architecture.html">
      Overview
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/architecture/capacity_and_utilization_collection_explanation">
      Capacity And Utilization Collection Explanation
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/architecture/enterprise">
      Enterprise
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/architecture/source_code_layout">
      Source Code Layout
    </a>
    
  </li>


      </ul>
    
  </li>

  
  
  
  <li class="menu-parent">
    
    <a href="#">
      Developer Setup
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/developer_setup.html">
      Overview
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/developer_setup/plugins">
      Plugins
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/developer_setup/minimal_mode">
      Minimal Mode
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item active">
    <a href="/docs/guides/developer_setup/running_test_suites">
      Running Test Suites
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/developer_setup/debugging">
      Interactive debugging
    </a>
    
  </li>


      </ul>
    
  </li>

  
  
  
  <li class="menu-parent">
    
    <a href="#">
      External Auth
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/external_auth.html">
      Overview
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/external_auth/configuration">
      Configuration
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/external_auth/installation">
      Installation
    </a>
    
  </li>


      </ul>
    
  </li>

  
  
  
  <li class="menu-parent">
    
    <a href="#">
      User Interface
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/ui/patterns">
      UI Patterns
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/ui/plugins">
      UI Plugins
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/ui/register_react_component">
      Shared React Component API
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/ui/report_data_api">
      Report Data API
    </a>
    
  </li>


      </ul>
    
  </li>

  
  
  
  <li class="menu-parent">
    
    <a href="#">
      Providers
    </a>
    
    
      <ul>
        



  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/architecture/providers_overview">
      Providers Overview
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/architecture/providers_database_architecture.html">
      Providers Database Architecture
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/providers/amazon_aws_config">
      Amazon AWS Config
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/providers/containers">
      Containers
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/providers/openshift">
      Openshift
    </a>
    
  </li>

  
  
  
  <li class="doc_menu-item">
    <a href="/docs/guides/providers/openstack_infra_provider">
      Openstack Infra Provider
    </a>
    
  </li>


      </ul>
    
  </li>

  
  
  
  <li>
    
    <a href="/docs/guides/provisioning/windows_imaging">
      Windows Imaging
    </a>
    
    
  </li>

  
  
  
  <li>
    
    <a href="/docs/guides/coding_style_and_standards">
      Coding Style And Standards
    </a>
    
    
  </li>

  
  
  
  <li>
    
    <a href="/docs/guides/i18n">
      I18n
    </a>
    
    
  </li>

</ul>

    
  </div>
  <div class="doc_main">
    <article class="doc dev_doc">
      

      <div class="doc-content">
        
        <h2 id="running-the-test-suites">Running the test suites</h2>

<p>Each ManageIQ component (providers, UI, vmdb, automation engine, etc.)
contains its own set of specs. Most of them can be run by executing</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec rake
</code></pre>
</div>

<p>Components that require non-standard invocation of the test suite are
documented in the remaining part of the document.</p>

<h3 id="running-the-vmdb-suite">Running the vmdb suite</h3>

<p>The ManageIQ test database needs to be setup before the test suite can be run.
This is automatically created if you run <code class="highlighter-rouge">bin/setup</code> or <code class="highlighter-rouge">bin/update</code>, but can
also be created using <code class="highlighter-rouge">bundle exec rake test:vmdb:setup</code>.</p>

<p>To run the suite, execute:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec rake
</code></pre>
</div>

<p>There are some other test related tasks available and those can be listed by
running</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec rake -T test
</code></pre>
</div>

<h3 id="running-the-vmdb-suite-in-parallel">Running the vmdb suite in parallel</h3>

<p>The main <code class="highlighter-rouge">vmdb</code> suite of tests can be run in parallel, utilizing multiple
processor cores. These separate processes run concurrently and are then
collected and reported on together when they all complete their delegated work.
You can run the entire vmdb suite or select spec files within it.</p>

<h4 id="setup">Setup</h4>

<p>Running tests in parallel requires as many different databases as cores you plan to run on.</p>

<p>To set up these databases, simply execute the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ PARALLEL=true bin/rake test:vmdb:setup
</code></pre>
</div>

<h4 id="run-the-entire-suite-in-parallel">Run the entire suite in parallel</h4>

<p>You can run the entire suite in parallel using the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ PARALLEL=true bin/rake test:vmdb
</code></pre>
</div>

<h4 id="passing-rspec-options-to-the-rake-tasks">Passing RSpec options to the rake tasks</h4>

<p>RSpec accepts a <code class="highlighter-rouge">SPEC_OPTS</code> environment variable to pass command line flags.
This is necessary when you wish to use some command line option with our
built-in rake commands to run the tests.</p>

<p>For example, I may wish to set a particular seed and stop running the tests
immediately on a failure:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ PARALLEL=true SPEC_OPTS="--seed 1234 --fail-fast" bin/rake test:vmdb:setup
</code></pre>
</div>

<p>Note that <code class="highlighter-rouge">--fail-fast</code> will stop whichever core encountered the error, not
every core at the first error found.</p>

<h4 id="running-specific-spec-files-in-parallel">Running specific spec files in parallel</h4>

<p>You neednâ€™t run the entire vmdb suite to take advantage of running tests in
parallel. Use <code class="highlighter-rouge">parallel_rspec</code> to run specific directories of spec files.</p>

<p>For example, I may have done some work on the front end and want to run the
controller, helper, and view specs specifically:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ parallel_rspec spec/controllers spec/helpers spec/views
</code></pre>
</div>

<p>This will run all of the specs in their respective directories, in parallel.
Note you do not need <code class="highlighter-rouge">PARALLEL=true</code> using <code class="highlighter-rouge">parallel_rspec</code>.</p>

<p><strong>Other tips:</strong></p>

<ul>
  <li>
    <p>You can get creative with searching and globbing patterns to feed to the
<code class="highlighter-rouge">parallel_rspec</code> command. For example, I might have recently made some pretty
drastic changes to role checking code having to do with a method named
<code class="highlighter-rouge">#role_allows</code>. To quickly run specs that <em>might</em> touch this code, I can pass
in all tests that mention it directly:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ parallel_rspec `git grep -l role_allows spec`
</code></pre>
    </div>
  </li>
  <li>
    <p>Each core requires a certain amount of overhead involved with loading all of
the application code, etc. Always running the maximum number of cores
available isnâ€™t always beneficial to fast tests. If youâ€™re running a subset
of tests and parallel_tests reports that youâ€™re running a very small number
of specs across each core, try using fewer cores doing more work instead. You
can specify the number with the <code class="highlighter-rouge">-n</code> option.  For example, to run all the
request specs with four cores:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ parallel_rspec -n 4 spec/requests
</code></pre>
    </div>
  </li>
  <li>
    <p>We use the <a href="https://github.com/grosser/parallel_tests">parallel_tests</a> gem to
make all of this possible - Go check out the documentation to learn even more
things you can do with running ManageIQ tests in parallel!</p>
  </li>
</ul>

<h3 id="running-ui-specs">Running UI specs</h3>

<p>Running the test suite for <code class="highlighter-rouge">manageiq-ui-classic</code> requires a bit more
preparation.</p>

<p>These instructions assume that you have <code class="highlighter-rouge">manageiq</code> and <code class="highlighter-rouge">manageiq-ui-classic</code>
cloned into <code class="highlighter-rouge">/home/u/miq/manageiq</code> and <code class="highlighter-rouge">/home/u/miq/manageiq-ui-classic</code>
respectively and that both repositores have the right branch checked out.</p>

<p>First, you need to symlink the core repo into spec folder of the UI repo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ln -s /home/u/miq/manageiq /home/u/miq/manageiq-ui-classic/spec/manageiq
</code></pre>
</div>

<p>Next, you need to ensure that <code class="highlighter-rouge">/home/u/miq/manageiq/bundler.d/overrides.rb</code>
file contains a block like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>override_gem "manageiq-ui-classic", path: "/home/u/miq/manageiq-ui-classic"
</code></pre>
</div>

<p>Now you must run <code class="highlighter-rouge">bin/update</code> from the <code class="highlighter-rouge">/home/u/miq/manageiq</code> folder, followed
by <code class="highlighter-rouge">bin/update</code> from the <code class="highlighter-rouge">/home/u/miq/manageiq-ui-classic</code> folder.</p>

<p>After all this is done, you can run tests as usual:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec rake
</code></pre>
</div>

<p>To run the javascript specs in <code class="highlighter-rouge">spec/javascripts/**/*_spec.js</code> in a headless
browser, you can run</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec rake spec:javascript
</code></pre>
</div>

<p>For debugging, <code class="highlighter-rouge">rake environment jasmine</code> runs a webserver listening on
<code class="highlighter-rouge">localhost:8888</code>.</p>

<p>You can also list all test-related rake tasks by running</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bundle exec rake -T spec
</code></pre>
</div>

      </div>
    </article>
  </div>
</div>

    </main>

    <footer class="site-footer">
  <div class="footer-row" id="footer_top">
    <div class="footer-group">
      <img class="footer-logo" src="/assets/images/manageiq-glyph-inverse.svg" alt="ManageIQ">
      <ul class="site_nav">
  <li >
    <a href="/download/">Download</a>
  </li>
  <li >
    <a href="/docs/">Documentation</a>
  </li>
  <li >
    <a href="/community/">Community</a>
  </li>
  <li >
    <a href="/blog/">Blog</a>
  </li>
</ul>

    </div>


    <ul class="contact_menu">
      <li>
        <a href="https://github.com/ManageIQ/">
          <i class="fa fa-github"></i>
          Github
        </a>
      </li>
      <li>
        <a href="https://gitter.im/ManageIQ/manageiq">
          <i class="fa fa-gitter">
            <svg viewBox="45 47 78 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 40.1 (33804) - http://www.bohemiancoding.com/sketch -->
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Artboard" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(45.000000, 47.000000)">
        <g id="icon-gitter" transform="translate(10.000000, 0.000000)">
            <rect id="Rectangle-path" x="0" y="0.5" width="8.25" height="61"></rect>
            <rect id="Rectangle-path" x="49.75" y="14.5" width="8.25" height="47"></rect>
            <rect id="Rectangle-path" x="16.5" y="14.5" width="8.25" height="80.25"></rect>
            <rect id="Rectangle-path" x="33.25" y="14.5" width="8.25" height="80.25"></rect>
        </g>
    </g>
</svg>

          </i>
          Gitter
        </a>
      </li>
      <li>
        <a href="http://talk.manageiq.org/">
          <i class="fa fa-comments"></i>
          Forum
        </a>
      </li>
    </ul>
  </div>

  <div class="footer-row" id="footer_bottom">
    <div class="footer-legal">
      <span class="copyright">
        &copy; 2019 ManageIQ.
      </span>
      <span>
        <a href="http://community.redhat.com/software/" target="_blank">
          Sponsored by Red Hat, Inc.
        </a>
      </span>
      <span>
        <a href="/logo/" class="footer-link">Logo</a>
      </span>
      <span>
        <a href="/security/" class="footer-link">Security</a>
      </span>
      <span>
        <a href="/legal/" class="footer-link">Legal &amp; Privacy</a>
      </span>
    </div>

    <div class="footer-social">
      <ul class="social_menu">
        <li>
          <a href="https://twitter.com/ManageIQ" class="social_link social_link-twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>

        <li>
          <a href="https://www.facebook.com/manageiq/" class="social_link social_link-facebook">
            <span class="social_link-icon">
              <i class="fa fa-facebook"></i>
            </span>
          </a>
        </li>

        <li>
          <a href="https://plus.google.com/+ManageiqOrg" class="social_link social_link-google_plus">
            <span class="social_link-icon">
              <i class="fa fa-google-plus"></i>
            </span>
          </a>
        </li>

        <!--  -->
        <li>
          <a href="https://www.linkedin.com/company/manageiq" class="social_link social_link-linkedin">
            <span class="social_link-icon">
              <i class="fa fa-linkedin"></i>
            </span>
          </a>
        </li>

        <li>
          <a href="https://www.youtube.com/user/ManageIQVideo" class="social_link social_link-youtube">
            <span class="social_link-icon">
              <i class="fa fa-youtube"></i>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

    <div id="lightbox">
  <header class="lightbox-header">
    <div class="lightbox-title"></div>
    <div class="lightbox-close">
      <span class="fa fa-times"></span>
    </div>
  </header>

  <div class="lightbox-image">
    <img src="" alt="">
  </div>
</div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="/assets/js/main.js" charset="utf-8"></script>
    
  </body>
</html>
